# DSR-publish Project

## الوصف
هذا المشروع عبارة عن سكربت بايثون يقوم بمعالجة بيانات تقارير الفواتير لإنشاء جداول محورية وتقارير ملخصة. يقوم السكربت بتحليل إجمالي الفواتير حسب المندوبين والتجار وأنواع الخدمات، ويحسب القيم المتوقعة اليومية والشهرية.

## الميزات
- قراءة بيانات الفواتير من ملف Excel.
- إنشاء جدول محوري مجمع يوضح إجمالي الفواتير حسب المندوب، التاجر، ونوع الخدمة.
- حساب الإجمالي اليومي والشهري المتوقع بناءً على آخر تاريخ في البيانات.
- إنشاء تقارير ملخصة للمندوبين، التجار، والخدمات.
- إضافة صفوف إجمالية كبرى للتقارير الملخصة.
- حفظ التقرير المجمع في ملف Excel واحد متعدد الأوراق.
- إنشاء تقارير Excel منفصلة لكل مندوب، تحتوي على تفاصيل الفواتير وملخص التجار الخاص به.

## كيفية الاستخدام
1.  **تجهيز البيانات**: تأكد من وجود ملف Excel باسم `تقرير الفواتير.xlsx` في نفس مجلد السكربت. يجب أن يحتوي الملف على الأعمدة التالية:
    - `MandoubCode` (رقم المندوب)
    - `MandoubName` (اسم المندوب)
    - `UserCode` (رقم التاجر)
    - `ShopName` (اسم التاجر)
    - `CategoryName` (نوع الخدمة)
    - `BillTotal` (المبلغ)
    - `Date` (التاريخ)

2.  **تشغيل السكربت**: قم بتشغيل ملف `pivot_dsr_script.py` باستخدام مترجم بايثون.
    ```bash
    python pivot_dsr_script.py
    ```

## المتطلبات
يتطلب السكربت مكتبة `pandas` لمعالجة البيانات. يمكنك تثبيتها باستخدام الأمر التالي:
```bash
pip install pandas openpyxl
```

## ملفات الإخراج
يقوم السكربت بإنشاء الملفات التالية:
- `Pivot_DSR_Report.xlsx`: تقرير Excel مجمع يحتوي على الأوراق التالية:
    - `تفاصيل`: الجدول المحوري الرئيسي مع الإجماليات.
    - `ملخص المندوبين`: ملخص إجمالي لكل مندوب.
    - `ملخص التجار`: ملخص إجمالي لكل تاجر.
    - `ملخص الخدمات`: ملخص إجمالي لكل خدمة.
    - `ملخص الخدمات والتجار`: ملخص الخدمات لكل تاجر.
- `Pivot_DSR_[MandoubName]_[MandoubCode].xlsx`: لكل مندوب، يتم إنشاء ملف Excel منفصل يحتوي على ورقتين:
    - `تفاصيل`: تفاصيل الفواتير الخاصة بالمندوب.
    - `ملخص التجار`: ملخص التجار التابعين لهذا المندوب.